/// <reference types="node" />
import { Server, ServerOptions, RequestListener, IncomingMessage, ServerResponse } from 'http';
import { Server as HTTPSServer, ServerOptions as HTTPSServerOptions } from 'https';
import { ListenOptions } from 'net';
import { Logger, LogLevel } from '@slack/logger';
import { InstallProvider, CallbackOptions, InstallProviderOptions, InstallURLOptions } from '@slack/oauth';
import { BufferedIncomingMessage } from './verify-request';
import App from '../App';
import { Receiver } from '../types';
import { CodedError } from '../errors';
import { CustomRoute } from './custom-routes';
import { StringIndexed } from '../types/helpers';
export interface HTTPReceiverOptions {
    signingSecret: string;
    endpoints?: string | string[];
    port?: number;
    customRoutes?: CustomRoute[];
    logger?: Logger;
    logLevel?: LogLevel;
    processBeforeResponse?: boolean;
    signatureVerification?: boolean;
    clientId?: string;
    clientSecret?: string;
    stateSecret?: InstallProviderOptions['stateSecret'];
    redirectUri?: string;
    installationStore?: InstallProviderOptions['installationStore'];
    scopes?: InstallURLOptions['scopes'];
    installerOptions?: HTTPReceiverInstallerOptions;
    customPropertiesExtractor?: (request: BufferedIncomingMessage) => StringIndexed;
    dispatchErrorHandler?: (args: HTTPReceiverDispatchErrorHandlerArgs) => void;
    processEventErrorHandler?: (args: HTTPReceiverProcessEventErrorHandlerArgs) => Promise<boolean>;
    unhandledRequestHandler?: (args: HTTPReceiverUnhandledRequestHandlerArgs) => void;
    unhandledRequestTimeoutMillis?: number;
}
export interface HTTPReceiverInstallerOptions {
    installPath?: string;
    directInstall?: boolean;
    renderHtmlForInstallPath?: (url: string) => string;
    redirectUriPath?: string;
    stateStore?: InstallProviderOptions['stateStore'];
    stateVerification?: InstallProviderOptions['stateVerification'];
    authVersion?: InstallProviderOptions['authVersion'];
    clientOptions?: InstallProviderOptions['clientOptions'];
    authorizationUrl?: InstallProviderOptions['authorizationUrl'];
    metadata?: InstallURLOptions['metadata'];
    userScopes?: InstallURLOptions['userScopes'];
    callbackOptions?: CallbackOptions;
    port?: number;
}
export interface HTTPReceiverDispatchErrorHandlerArgs {
    error: Error | CodedError;
    logger: Logger;
    request: IncomingMessage;
    response: ServerResponse;
}
export declare function defaultDispatchErrorHandler(args: HTTPReceiverDispatchErrorHandlerArgs): void;
export interface HTTPReceiverProcessEventErrorHandlerArgs {
    error: Error | CodedError;
    logger: Logger;
    request: IncomingMessage;
    response: ServerResponse;
    storedResponse: any;
}
export declare function defaultProcessEventErrorHandler(args: HTTPReceiverProcessEventErrorHandlerArgs): Promise<boolean>;
export interface HTTPReceiverUnhandledRequestHandlerArgs {
    logger: Logger;
    request: IncomingMessage;
    response: ServerResponse;
}
export declare function defaultUnhandledRequestHandler(args: HTTPReceiverUnhandledRequestHandlerArgs): void;
/**
 * Receives HTTP requests with Events, Slash Commands, and Actions
 */
export default class HTTPReceiver implements Receiver {
    private endpoints;
    private port;
    private routes;
    private signingSecret;
    private processBeforeResponse;
    private signatureVerification;
    private app?;
    requestListener: RequestListener;
    private server?;
    installer?: InstallProvider;
    private installPath?;
    private directInstall?;
    private renderHtmlForInstallPath;
    private installRedirectUriPath?;
    private installUrlOptions?;
    private installCallbackOptions?;
    private stateVerification?;
    private logger;
    private customPropertiesExtractor;
    private dispatchErrorHandler;
    private processEventErrorHandler;
    private unhandledRequestHandler;
    private unhandledRequestTimeoutMillis;
    constructor({ signingSecret, endpoints, port, customRoutes, logger, logLevel, processBeforeResponse, signatureVerification, clientId, clientSecret, stateSecret, redirectUri, installationStore, scopes, installerOptions, customPropertiesExtractor, dispatchErrorHandler, processEventErrorHandler, unhandledRequestHandler, unhandledRequestTimeoutMillis, }: HTTPReceiverOptions);
    init(app: App): void;
    start(port: number): Promise<Server>;
    start(portOrListenOptions: number | ListenOptions, serverOptions?: ServerOptions): Promise<Server>;
    start(portOrListenOptions: number | ListenOptions, httpsServerOptions?: HTTPSServerOptions): Promise<HTTPSServer>;
    stop(): Promise<void>;
    private unboundRequestListener;
    private handleIncomingEvent;
    private handleInstallPathRequest;
    private handleInstallRedirectRequest;
}
//# sourceMappingURL=HTTPReceiver.d.ts.map