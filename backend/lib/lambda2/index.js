"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.handler = void 0;
const aws_sdk_1 = require("aws-sdk");
const const_1 = require("./const");
const meeting_1 = require("./meeting");
const util_1 = require("./util");
var meetingTableName = process.env.MEETING_TABLE_NAME;
var attendeesTableName = process.env.ATTENDEE_TABLE_NAME;
var ddb = new aws_sdk_1.DynamoDB();
const Methods = {
    GET: "GET",
    POST: "POST",
    DELETE: "DELETE",
};
const Resources = {
    Root: "/",
    Meetings: "/meetings",
    Meeting: "/meetings/{meetingName}",
    Attendees: "/meetings/{meetingName}/attendees",
    Attendee: "/meetings/{meetingName}/attendees/{attendeeId}",
};
const Codes = {
    SUCCESS: "SUCCESS",
    UNKNOWN_RESOURCE: "UNKNOWN_RESOURCE",
    UNKNOWN_METHOD: "UNKNOWN_METHOD",
    TOKEN_ERROR: "TOKEN_ERROR",
    PARAMETER_ERROR: "PARAMETER_ERROR",
    NO_SUCH_A_MEETING_ROOM: "NO_SUCH_A_MEETING_ROOM",
    NO_SUCH_AN_ATTENDEE: "NO_SUCH_AN_ATTENDEE",
};
const handler = (event, context, callback) => {
    console.log(event);
    console.log("resource:", event.resource);
    console.log("pathPArameters:", event.pathParameters);
    console.log("method", event.httpMethod);
    console.log("body", event.body);
    const resource = event.resource;
    const pathParams = event.pathParameters;
    const method = event.httpMethod;
    const body = event.body;
    const accessToken = event.headers["x-flect-access-token"];
    console.log("pathParams", pathParams);
    switch (resource) {
        case Resources.Root:
            handleRoot(accessToken, method, pathParams, body, callback);
            break;
        case Resources.Meetings:
            handleMeetings(accessToken, method, pathParams, body, callback);
            break;
        case Resources.Meeting:
            handleMeeting(accessToken, method, pathParams, body, callback);
            break;
        case Resources.Attendees:
            handleAttendees(accessToken, method, pathParams, body, callback);
            break;
        case Resources.Attendee:
            handleAttendee(accessToken, method, pathParams, body, callback);
            break;
        default:
            console.log(`Unknwon resource name: ${resource}`);
            const response = (0, util_1.generateResponse)({ success: false, code: Codes.UNKNOWN_RESOURCE });
            callback(null, response);
    }
    // const response = getResponseTemplate();
    // const meetingName = "TEST";
    // const result = await ddb
    //     .getItem({
    //         TableName: meetingTableName,
    //         Key: {
    //             MeetingName: {
    //                 S: meetingName,
    //             },
    //         },
    //     })
    //     .promise();
    // console.log("dynamo", result);
    // //// (2) If no meeting in DB, return null
    // if (!result.Item) {
    //     response.body = JSON.stringify({ x: 5, y: 6 });
    // } else {
    //     const meetingInfo = result.Item;
    //     const meetingData = JSON.parse(meetingInfo.Data.S!);
    //     response.body = JSON.stringify(meetingData);
    // }
};
exports.handler = handler;
// (0) Root
const handleRoot = (accessToken, method, pathParams, body, callback) => {
    console.log(`HANDLE ROOT: ${method} ${body}`);
    const response = (0, util_1.generateResponse)({ success: true, code: Codes.SUCCESS });
    callback(null, response);
};
// (1) meetings
const handleMeetings = (accessToken, method, pathParams, body, callback) => {
    console.log(`HANDLE Meetings: ${method} ${body}`);
    switch (method) {
        case Methods.GET:
            handleGetMeetings(accessToken, pathParams, body, callback);
            break;
        case Methods.POST:
            handlePostMeetings(accessToken, pathParams, body, callback);
            break;
        default:
            console.log(`Unknwon method: ${method}`);
            const response = (0, util_1.generateResponse)({ success: false, code: Codes.UNKNOWN_METHOD });
            callback(null, response);
            break;
    }
};
//// (1-1) get meetings
const handleGetMeetings = (accessToken, pathParams, body, callback) => {
    ////// Not implemented
    const response = (0, util_1.generateResponse)({ success: true, code: Codes.SUCCESS });
    callback(null, response);
};
//// (1-2) post meetings
const handlePostMeetings = async (accessToken, pathParams, body, callback) => {
    const params = JSON.parse(body);
    let email;
    try {
        email = await (0, util_1.getEmailFromAccessToken)(accessToken);
    }
    catch (e) {
        console.log(e);
    }
    let res;
    if (email) {
        const result = await (0, meeting_1.createMeeting)(email, params.meetingName, params.region);
        res = {
            success: true,
            code: Codes.SUCCESS,
            data: result,
        };
    }
    else {
        res = {
            success: false,
            code: Codes.TOKEN_ERROR,
        };
    }
    const response = (0, util_1.generateResponse)(res);
    callback(null, response);
};
// (2) meetings
const handleMeeting = (accessToken, method, pathParams, body, callback) => {
    console.log(`HANDLE Meeting: ${method} ${body}`);
    switch (method) {
        case Methods.GET:
            handleGetMeeting(accessToken, pathParams, body, callback);
            break;
        case Methods.DELETE:
            handleDeleteMeeting(accessToken, pathParams, body, callback);
            break;
        default:
            console.log(`Unknwon method: ${method}`);
            const response = (0, util_1.generateResponse)({ success: false, code: Codes.UNKNOWN_METHOD });
            callback(null, response);
            break;
    }
};
//// (2-1) Get Meeting
const handleGetMeeting = async (accessToken, pathParams, body, callback) => {
    let res;
    const meetingName = pathParams["meetingName"];
    if (!meetingName) {
        console.log(`parameter error: ${meetingName}`);
        res = {
            success: false,
            code: Codes.PARAMETER_ERROR,
        };
    }
    else {
        const result = await (0, meeting_1.getMeetingInfo)(meetingName);
        if (!result) {
            res = {
                success: false,
                code: Codes.NO_SUCH_A_MEETING_ROOM,
            };
        }
        else {
            res = {
                success: true,
                code: Codes.SUCCESS,
                data: result,
            };
        }
    }
    const response = (0, util_1.generateResponse)(res);
    callback(null, response);
};
//// (2-2) Delete Meeting
const handleDeleteMeeting = async (accessToken, pathParams, body, callback) => {
    let res;
    const meetingName = pathParams["meetingName"];
    if (!meetingName) {
        console.log(`parameter error: ${meetingName}`);
        res = {
            success: false,
            code: Codes.PARAMETER_ERROR,
        };
    }
    else {
        await (0, meeting_1.deleteMeeting)(meetingName);
        res = {
            success: true,
            code: Codes.SUCCESS,
        };
    }
    const response = (0, util_1.generateResponse)(res);
    callback(null, response);
};
// (3) attendees
const handleAttendees = (accessToken, method, pathParams, body, callback) => {
    console.log(`HANDLE attendees: ${method} ${body}`);
    switch (method) {
        case Methods.GET:
            handleGetAttendees(accessToken, pathParams, body, callback);
            break;
        case Methods.POST:
            handlePostAttendees(accessToken, pathParams, body, callback);
            break;
        default:
            console.log(`Unknwon method: ${method}`);
            const response = (0, util_1.generateResponse)({ success: false, code: Codes.UNKNOWN_METHOD });
            callback(null, response);
            break;
    }
};
//// (3-1) Get Attendees
const handleGetAttendees = async (accessToken, pathParams, body, callback) => {
    // let res: ResponseBody;
    // const response = generateResponse(res);
    // callback(null, response);
};
//// (3-2) Post Attendees
const handlePostAttendees = async (accessToken, pathParams, body, callback) => {
    let res;
    const params = JSON.parse(body);
    const joinInfo = await (0, meeting_1.joinMeeting)(params.meetingName, params.attendeeName);
    if ("exception" in joinInfo) {
        const exception = joinInfo;
        if (exception.code === const_1.JoinMeetingExceptionType.NO_MEETING_FOUND) {
            res = {
                success: false,
                code: Codes.NO_SUCH_A_MEETING_ROOM,
            };
        }
        else {
            res = {
                success: false,
                code: Codes.PARAMETER_ERROR,
            };
        }
    }
    else {
        res = {
            success: true,
            code: Codes.SUCCESS,
            data: joinInfo,
        };
    }
    const response = (0, util_1.generateResponse)(res);
    callback(null, response);
};
// (4) attendees
const handleAttendee = (accessToken, method, pathParams, body, callback) => {
    console.log(`HANDLE attendee: ${method} ${body}`);
    switch (method) {
        case Methods.GET:
            handleGetAttendee(accessToken, pathParams, body, callback);
            break;
        default:
            console.log(`Unknwon method: ${method}`);
            const response = (0, util_1.generateResponse)({ success: false, code: Codes.UNKNOWN_METHOD });
            callback(null, response);
            break;
    }
};
//// (4-1) Get Attendee
const handleGetAttendee = async (accessToken, pathParams, body, callback) => {
    let res;
    const meetingName = pathParams["meetingName"];
    const attendeeId = pathParams["attendeeId"];
    if (!meetingName || !attendeeId) {
        console.log(`parameter error: ${meetingName}, ${attendeeId}`);
        res = {
            success: false,
            code: Codes.PARAMETER_ERROR,
        };
    }
    else {
        const attendeeInfo = await (0, meeting_1.getAttendeeInfo)(meetingName, attendeeId);
        if ("exception" in attendeeInfo) {
            const exception = attendeeInfo;
            if (exception.code === const_1.GetAttendeeInfoExceptionType.NO_ATTENDEE_FOUND) {
                res = {
                    success: false,
                    code: Codes.NO_SUCH_AN_ATTENDEE,
                };
            }
            else {
                res = {
                    success: false,
                    code: Codes.PARAMETER_ERROR,
                };
            }
        }
        else {
            res = {
                success: true,
                code: Codes.SUCCESS,
                data: attendeeInfo,
            };
        }
    }
    const response = (0, util_1.generateResponse)(res);
    callback(null, response);
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJpbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQSxxQ0FBbUM7QUFDbkMsbUNBQXlMO0FBQ3pMLHVDQUF1RztBQUN2RyxpQ0FBbUU7QUFFbkUsSUFBSSxnQkFBZ0IsR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDLGtCQUFtQixDQUFDO0FBQ3ZELElBQUksa0JBQWtCLEdBQUcsT0FBTyxDQUFDLEdBQUcsQ0FBQyxtQkFBb0IsQ0FBQztBQUMxRCxJQUFJLEdBQUcsR0FBRyxJQUFJLGtCQUFRLEVBQUUsQ0FBQztBQUV6QixNQUFNLE9BQU8sR0FBRztJQUNaLEdBQUcsRUFBRSxLQUFLO0lBQ1YsSUFBSSxFQUFFLE1BQU07SUFDWixNQUFNLEVBQUUsUUFBUTtDQUNWLENBQUM7QUFHWCxNQUFNLFNBQVMsR0FBRztJQUNkLElBQUksRUFBRSxHQUFHO0lBQ1QsUUFBUSxFQUFFLFdBQVc7SUFDckIsT0FBTyxFQUFFLHlCQUF5QjtJQUNsQyxTQUFTLEVBQUUsbUNBQW1DO0lBQzlDLFFBQVEsRUFBRSxnREFBZ0Q7Q0FDcEQsQ0FBQztBQUdYLE1BQU0sS0FBSyxHQUFHO0lBQ1YsT0FBTyxFQUFFLFNBQVM7SUFDbEIsZ0JBQWdCLEVBQUUsa0JBQWtCO0lBQ3BDLGNBQWMsRUFBRSxnQkFBZ0I7SUFDaEMsV0FBVyxFQUFFLGFBQWE7SUFDMUIsZUFBZSxFQUFFLGlCQUFpQjtJQUNsQyxzQkFBc0IsRUFBRSx3QkFBd0I7SUFDaEQsbUJBQW1CLEVBQUUscUJBQXFCO0NBQ3BDLENBQUM7QUFHSixNQUFNLE9BQU8sR0FBRyxDQUFDLEtBQVUsRUFBRSxPQUFZLEVBQUUsUUFBYSxFQUFFLEVBQUU7SUFDL0QsT0FBTyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUNuQixPQUFPLENBQUMsR0FBRyxDQUFDLFdBQVcsRUFBRSxLQUFLLENBQUMsUUFBUSxDQUFDLENBQUM7SUFDekMsT0FBTyxDQUFD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QUFNO1lBQ0gsR0FBRyxHQUFHO2dCQUNGLE9BQU8sRUFBRSxJQUFJO2dCQUNiLElBQUksRUFBRSxLQUFLLENBQUMsT0FBTztnQkFDbkIsSUFBSSxFQUFFLFlBQVk7YUFDckIsQ0FBQztTQUNMO0tBQ0o7SUFDRCxNQUFNLFFBQVEsR0FBRyxJQUFBLHVCQUFnQixFQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ3ZDLFFBQVEsQ0FBQyxJQUFJLEVBQUUsUUFBUSxDQUFDLENBQUM7QUFDN0IsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRHluYW1vREIgfSBmcm9tIFwiYXdzLXNka1wiO1xuaW1wb3J0IHsgQ3JlYXRlTWVldGluZ1JlcXVlc3QsIEpvaW5NZWV0aW5nUmVxdWVzdCwgUmVzcG9uc2VCb2R5LCBKb2luTWVldGluZ0V4Y2VwdGlvbiwgSm9pbk1lZXRpbmdFeGNlcHRpb25UeXBlLCBHZXRBdHRlbmRlZUluZm9FeGNlcHRpb24sIEdldEF0dGVuZGVlSW5mb0V4Y2VwdGlvblR5cGUgfSBmcm9tIFwiLi9jb25zdFwiO1xuaW1wb3J0IHsgY3JlYXRlTWVldGluZywgZGVsZXRlTWVldGluZywgZ2V0QXR0ZW5kZWVJbmZvLCBnZXRNZWV0aW5nSW5mbywgam9pbk1lZXRpbmcgfSBmcm9tIFwiLi9tZWV0aW5nXCI7XG5pbXBvcnQgeyBnZW5lcmF0ZVJlc3BvbnNlLCBnZXRFbWFpbEZyb21BY2Nlc3NUb2tlbiB9IGZyb20gXCIuL3V0aWxcIjtcblxudmFyIG1lZXRpbmdUYWJsZU5hbWUgPSBwcm9jZXNzLmVudi5NRUVUSU5HX1RBQkxFX05BTUUhO1xudmFyIGF0dGVuZGVlc1RhYmxlTmFtZSA9IHByb2Nlc3MuZW52LkFUVEVOREVFX1RBQkxFX05BTUUhO1xudmFyIGRkYiA9IG5ldyBEeW5hbW9EQigpO1xuXG5jb25zdCBNZXRob2RzID0ge1xuICAgIEdFVDogXCJHRVRcIixcbiAgICBQT1NUOiBcIlBPU1RcIixcbiAgICBERUxFVEU6IFwiREVMRVRFXCIsXG59IGFzIGNvbnN0O1xudHlwZSBNZXRob2RzID0gdHlwZW9mIE1ldGhvZHNba2V5b2YgdHlwZW9mIE1ldGhvZHNdO1xuXG5jb25zdCBSZXNvdXJjZXMgPSB7XG4gICAgUm9vdDogXCIvXCIsXG4gICAgTWVldGluZ3M6IFwiL21lZXRpbmdzXCIsXG4gICAgTWVldGluZzogXCIvbWVldGluZ3Mve21lZXRpbmdOYW1lfVwiLFxuICAgIEF0dGVuZGVlczogXCIvbWVldGluZ3Mve21lZXRpbmdOYW1lfS9hdHRlbmRlZXNcIixcbiAgICBBdHRlbmRlZTogXCIvbWVldGluZ3Mve21lZXRpbmdOYW1lfS9hdHRlbmRlZXMve2F0dGVuZGVlSWR9XCIsXG59IGFzIGNvbnN0O1xudHlwZSBSZXNvdXJjZXMgPSB0eXBlb2YgUmVzb3VyY2VzW2tleW9mIHR5cGVvZiBSZXNvdXJjZXNdO1xuXG5jb25zdCBDb2RlcyA9IHtcbiAgICBTVUNDRVNTOiBcIlNVQ0NFU1NcIixcbiAgICBVTktOT1dOX1JFU09VUkNFOiBcIlVOS05PV05fUkVTT1VSQ0VcIixcbiAgICBVTktOT1dOX01FVEhPRDogXCJVTktOT1dOX01FVEhPRFwiLFxuICAgIFRPS0VOX0VSUk9SOiBcIlRPS0VOX0VSUk9SXCIsXG4gICAgUEFSQU1FVEVSX0VSUk9SOiBcIlBBUkFNRVRFUl9FUlJPUlwiLFxuICAgIE5PX1NVQ0hfQV9NRUVUSU5HX1JPT006IFwiTk9fU1VDSF9BX01FRVRJTkdfUk9PTVwiLFxuICAgIE5PX1NVQ0hfQU5fQVRURU5ERUU6IFwiTk9fU1VDSF9BTl9BVFRFTkRFRVwiLFxufSBhcyBjb25zdDtcbnR5cGUgQ29kZSA9IHR5cGVvZiBDb2Rlc1trZXlvZiB0eXBlb2YgQ29kZXNdO1xuXG5leHBvcnQgY29uc3QgaGFuZGxlciA9IChldmVudDogYW55LCBjb250ZXh0OiBhbnksIGNhbGxiYWNrOiBhbnkpID0+IHtcbiAgICBjb25zb2xlLmxvZyhldmVudCk7XG4gICAgY29uc29sZS5sb2coXCJyZXNvdXJjZTpcIiwgZXZlbnQucmVzb3VyY2UpO1xuICAgIGNvbnNvbGUubG9nKFwicGF0aFBBcmFtZXRlcnM6XCIsIGV2ZW50LnBhdGhQYXJhbWV0ZXJzKTtcbiAgICBjb25zb2xlLmxvZyhcIm1ldGhvZFwiLCBldmVudC5odHRwTWV0aG9kKTtcbiAgICBjb25zb2xlLmxvZyhcImJvZHlcIiwgZXZlbnQuYm9keSk7XG5cbiAgICBjb25zdCByZXNvdXJjZSA9IGV2ZW50LnJlc291cmNlO1xuICAgIGNvbnN0IHBhdGhQYXJhbXMgPSBldmVudC5wYXRoUGFyYW1ldGVycztcbiAgICBjb25zdCBtZXRob2QgPSBldmVudC5odHRwTWV0aG9kO1xuICAgIGNvbnN0IGJvZHkgPSBldmVudC5ib2R5O1xuICAgIGNvbnN0IGFjY2Vzc1Rva2VuID0gZXZlbnQuaGVhZGVyc1tcIngtZmxlY3QtYWNjZXNzLXRva2VuXCJdO1xuXG4gICAgY29uc29sZS5sb2coXCJwYXRoUGFyYW1zXCIsIHBhdGhQYXJhbXMpO1xuXG4gICAgc3dpdGNoIChyZXNvdXJjZSkge1xuICAgICAgICBjYXNlIFJlc291cmNlcy5Sb290OlxuICAgICAgICAgICAgaGFuZGxlUm9vdChhY2Nlc3NUb2tlbiwgbWV0aG9kLCBwYXRoUGFyYW1zLCBib2R5LCBjYWxsYmFjayk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBSZXNvdXJjZXMuTWVldGluZ3M6XG4gICAgICAgICAgICBoYW5kbGVNZWV0aW5ncyhhY2Nlc3NUb2tlbiwgbWV0aG9kLCBwYXRoUGFyYW1zLCBib2R5LCBjYWxsYmFjayk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBSZXNvdXJjZXMuTWVldGluZzpcbiAgICAgICAgICAgIGhhbmRsZU1lZXRpbmcoYWNjZXNzVG9rZW4sIG1ldGhvZCwgcGF0aFBhcmFtcywgYm9keSwgY2FsbGJhY2spO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgUmVzb3VyY2VzLkF0dGVuZGVlczpcbiAgICAgICAgICAgIGhhbmRsZUF0dGVuZGVlcyhhY2Nlc3NUb2tlbiwgbWV0aG9kLCBwYXRoUGFyYW1zLCBib2R5LCBjYWxsYmFjayk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBSZXNvdXJjZXMuQXR0ZW5kZWU6XG4gICAgICAgICAgICBoYW5kbGVBdHRlbmRlZShhY2Nlc3NUb2tlbiwgbWV0aG9kLCBwYXRoUGFyYW1zLCBib2R5LCBjYWxsYmFjayk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBVbmtud29uIHJlc291cmNlIG5hbWU6ICR7cmVzb3VyY2V9YCk7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGdlbmVyYXRlUmVzcG9uc2UoeyBzdWNjZXNzOiBmYWxzZSwgY29kZTogQ29kZXMuVU5LTk9XTl9SRVNPVVJDRSB9KTtcbiAgICAgICAgICAgIGNhbGxiYWNrKG51bGwsIHJlc3BvbnNlKTtcbiAgICB9XG5cbiAgICAvLyBjb25zdCByZXNwb25zZSA9IGdldFJlc3BvbnNlVGVtcGxhdGUoKTtcbiAgICAvLyBjb25zdCBtZWV0aW5nTmFtZSA9IFwiVEVTVFwiO1xuICAgIC8vIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRkYlxuICAgIC8vICAgICAuZ2V0SXRlbSh7XG4gICAgLy8gICAgICAgICBUYWJsZU5hbWU6IG1lZXRpbmdUYWJsZU5hbWUsXG4gICAgLy8gICAgICAgICBLZXk6IHtcbiAgICAvLyAgICAgICAgICAgICBNZWV0aW5nTmFtZToge1xuICAgIC8vICAgICAgICAgICAgICAgICBTOiBtZWV0aW5nTmFtZSxcbiAgICAvLyAgICAgICAgICAgICB9LFxuICAgIC8vICAgICAgICAgfSxcbiAgICAvLyAgICAgfSlcbiAgICAvLyAgICAgLnByb21pc2UoKTtcblxuICAgIC8vIGNvbnNvbGUubG9nKFwiZHluYW1vXCIsIHJlc3VsdCk7XG4gICAgLy8gLy8vLyAoMikgSWYgbm8gbWVldGluZyBpbiBEQiwgcmV0dXJuIG51bGxcbiAgICAvLyBpZiAoIXJlc3VsdC5JdGVtKSB7XG4gICAgLy8gICAgIHJlc3BvbnNlLmJvZHkgPSBKU09OLnN0cmluZ2lmeSh7IHg6IDUsIHk6IDYgfSk7XG4gICAgLy8gfSBlbHNlIHtcbiAgICAvLyAgICAgY29uc3QgbWVldGluZ0luZm8gPSByZXN1bHQuSXRlbTtcbiAgICAvLyAgICAgY29uc3QgbWVldGluZ0RhdGEgPSBKU09OLnBhcnNlKG1lZXRpbmdJbmZvLkRhdGEuUyEpO1xuICAgIC8vICAgICByZXNwb25zZS5ib2R5ID0gSlNPTi5zdHJpbmdpZnkobWVldGluZ0RhdGEpO1xuICAgIC8vIH1cbn07XG5cbi8vICgwKSBSb290XG5jb25zdCBoYW5kbGVSb290ID0gKGFjY2Vzc1Rva2VuOiBzdHJpbmcsIG1ldGhvZDogc3RyaW5nLCBwYXRoUGFyYW1zOiB7IFtrZXk6IHN0cmluZ106IHN0cmluZyB9LCBib2R5OiBhbnksIGNhbGxiYWNrOiBhbnkpID0+IHtcbiAgICBjb25zb2xlLmxvZyhgSEFORExFIFJPT1Q6ICR7bWV0aG9kfSAke2JvZHl9YCk7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBnZW5lcmF0ZVJlc3BvbnNlKHsgc3VjY2VzczogdHJ1ZSwgY29kZTogQ29kZXMuU1VDQ0VTUyB9KTtcbiAgICBjYWxsYmFjayhudWxsLCByZXNwb25zZSk7XG59O1xuXG4vLyAoMSkgbWVldGluZ3NcbmNvbnN0IGhhbmRsZU1lZXRpbmdzID0gKGFjY2Vzc1Rva2VuOiBzdHJpbmcsIG1ldGhvZDogc3RyaW5nLCBwYXRoUGFyYW1zOiB7IFtrZXk6IHN0cmluZ106IHN0cmluZyB9LCBib2R5OiBhbnksIGNhbGxiYWNrOiBhbnkpID0+IHtcbiAgICBjb25zb2xlLmxvZyhgSEFORExFIE1lZXRpbmdzOiAke21ldGhvZH0gJHtib2R5fWApO1xuICAgIHN3aXRjaCAobWV0aG9kKSB7XG4gICAgICAgIGNhc2UgTWV0aG9kcy5HRVQ6XG4gICAgICAgICAgICBoYW5kbGVHZXRNZWV0aW5ncyhhY2Nlc3NUb2tlbiwgcGF0aFBhcmFtcywgYm9keSwgY2FsbGJhY2spO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgTWV0aG9kcy5QT1NUOlxuICAgICAgICAgICAgaGFuZGxlUG9zdE1lZXRpbmdzKGFjY2Vzc1Rva2VuLCBwYXRoUGFyYW1zLCBib2R5LCBjYWxsYmFjayk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBVbmtud29uIG1ldGhvZDogJHttZXRob2R9YCk7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGdlbmVyYXRlUmVzcG9uc2UoeyBzdWNjZXNzOiBmYWxzZSwgY29kZTogQ29kZXMuVU5LTk9XTl9NRVRIT0QgfSk7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsLCByZXNwb25zZSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICB9XG59O1xuLy8vLyAoMS0xKSBnZXQgbWVldGluZ3NcbmNvbnN0IGhhbmRsZUdldE1lZXRpbmdzID0gKGFjY2Vzc1Rva2VuOiBzdHJpbmcsIHBhdGhQYXJhbXM6IHsgW2tleTogc3RyaW5nXTogc3RyaW5nIH0sIGJvZHk6IGFueSwgY2FsbGJhY2s6IGFueSkgPT4ge1xuICAgIC8vLy8vLyBOb3QgaW1wbGVtZW50ZWRcbiAgICBjb25zdCByZXNwb25zZSA9IGdlbmVyYXRlUmVzcG9uc2UoeyBzdWNjZXNzOiB0cnVlLCBjb2RlOiBDb2Rlcy5TVUNDRVNTIH0pO1xuICAgIGNhbGxiYWNrKG51bGwsIHJlc3BvbnNlKTtcbn07XG4vLy8vICgxLTIpIHBvc3QgbWVldGluZ3NcbmNvbnN0IGhhbmRsZVBvc3RNZWV0aW5ncyA9IGFzeW5jIChhY2Nlc3NUb2tlbjogc3RyaW5nLCBwYXRoUGFyYW1zOiB7IFtrZXk6IHN0cmluZ106IHN0cmluZyB9LCBib2R5OiBhbnksIGNhbGxiYWNrOiBhbnkpID0+IHtcbiAgICBjb25zdCBwYXJhbXMgPSBKU09OLnBhcnNlKGJvZHkpIGFzIENyZWF0ZU1lZXRpbmdSZXF1ZXN0O1xuICAgIGxldCBlbWFpbDtcbiAgICB0cnkge1xuICAgICAgICBlbWFpbCA9IGF3YWl0IGdldEVtYWlsRnJvbUFjY2Vzc1Rva2VuKGFjY2Vzc1Rva2VuKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGUpO1xuICAgIH1cbiAgICBsZXQgcmVzOiBSZXNwb25zZUJvZHk7XG4gICAgaWYgKGVtYWlsKSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNyZWF0ZU1lZXRpbmcoZW1haWwsIHBhcmFtcy5tZWV0aW5nTmFtZSwgcGFyYW1zLnJlZ2lvbik7XG4gICAgICAgIHJlcyA9IHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICBjb2RlOiBDb2Rlcy5TVUNDRVNTLFxuICAgICAgICAgICAgZGF0YTogcmVzdWx0LFxuICAgICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJlcyA9IHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgY29kZTogQ29kZXMuVE9LRU5fRVJST1IsXG4gICAgICAgIH07XG4gICAgfVxuICAgIGNvbnN0IHJlc3BvbnNlID0gZ2VuZXJhdGVSZXNwb25zZShyZXMpO1xuICAgIGNhbGxiYWNrKG51bGwsIHJlc3BvbnNlKTtcbn07XG4vLyAoMikgbWVldGluZ3NcbmNvbnN0IGhhbmRsZU1lZXRpbmcgPSAoYWNjZXNzVG9rZW46IHN0cmluZywgbWV0aG9kOiBzdHJpbmcsIHBhdGhQYXJhbXM6IHsgW2tleTogc3RyaW5nXTogc3RyaW5nIH0sIGJvZHk6IGFueSwgY2FsbGJhY2s6IGFueSkgPT4ge1xuICAgIGNvbnNvbGUubG9nKGBIQU5ETEUgTWVldGluZzogJHttZXRob2R9ICR7Ym9keX1gKTtcbiAgICBzd2l0Y2ggKG1ldGhvZCkge1xuICAgICAgICBjYXNlIE1ldGhvZHMuR0VUOlxuICAgICAgICAgICAgaGFuZGxlR2V0TWVldGluZyhhY2Nlc3NUb2tlbiwgcGF0aFBhcmFtcywgYm9keSwgY2FsbGJhY2spO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgTWV0aG9kcy5ERUxFVEU6XG4gICAgICAgICAgICBoYW5kbGVEZWxldGVNZWV0aW5nKGFjY2Vzc1Rva2VuLCBwYXRoUGFyYW1zLCBib2R5LCBjYWxsYmFjayk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBVbmtud29uIG1ldGhvZDogJHttZXRob2R9YCk7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGdlbmVyYXRlUmVzcG9uc2UoeyBzdWNjZXNzOiBmYWxzZSwgY29kZTogQ29kZXMuVU5LTk9XTl9NRVRIT0QgfSk7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsLCByZXNwb25zZSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICB9XG59O1xuLy8vLyAoMi0xKSBHZXQgTWVldGluZ1xuY29uc3QgaGFuZGxlR2V0TWVldGluZyA9IGFzeW5jIChhY2Nlc3NUb2tlbjogc3RyaW5nLCBwYXRoUGFyYW1zOiB7IFtrZXk6IHN0cmluZ106IHN0cmluZyB9LCBib2R5OiBhbnksIGNhbGxiYWNrOiBhbnkpID0+IHtcbiAgICBsZXQgcmVzOiBSZXNwb25zZUJvZHk7XG4gICAgY29uc3QgbWVldGluZ05hbWUgPSBwYXRoUGFyYW1zW1wibWVldGluZ05hbWVcIl07XG4gICAgaWYgKCFtZWV0aW5nTmFtZSkge1xuICAgICAgICBjb25zb2xlLmxvZyhgcGFyYW1ldGVyIGVycm9yOiAke21lZXRpbmdOYW1lfWApO1xuICAgICAgICByZXMgPSB7XG4gICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgIGNvZGU6IENvZGVzLlBBUkFNRVRFUl9FUlJPUixcbiAgICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBnZXRNZWV0aW5nSW5mbyhtZWV0aW5nTmFtZSk7XG4gICAgICAgIGlmICghcmVzdWx0KSB7XG4gICAgICAgICAgICByZXMgPSB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgY29kZTogQ29kZXMuTk9fU1VDSF9BX01FRVRJTkdfUk9PTSxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXMgPSB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICBjb2RlOiBDb2Rlcy5TVUNDRVNTLFxuICAgICAgICAgICAgICAgIGRhdGE6IHJlc3VsdCxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgcmVzcG9uc2UgPSBnZW5lcmF0ZVJlc3BvbnNlKHJlcyk7XG4gICAgY2FsbGJhY2sobnVsbCwgcmVzcG9uc2UpO1xufTtcblxuLy8vLyAoMi0yKSBEZWxldGUgTWVldGluZ1xuY29uc3QgaGFuZGxlRGVsZXRlTWVldGluZyA9IGFzeW5jIChhY2Nlc3NUb2tlbjogc3RyaW5nLCBwYXRoUGFyYW1zOiB7IFtrZXk6IHN0cmluZ106IHN0cmluZyB9LCBib2R5OiBhbnksIGNhbGxiYWNrOiBhbnkpID0+IHtcbiAgICBsZXQgcmVzOiBSZXNwb25zZUJvZHk7XG4gICAgY29uc3QgbWVldGluZ05hbWUgPSBwYXRoUGFyYW1zW1wibWVldGluZ05hbWVcIl07XG4gICAgaWYgKCFtZWV0aW5nTmFtZSkge1xuICAgICAgICBjb25zb2xlLmxvZyhgcGFyYW1ldGVyIGVycm9yOiAke21lZXRpbmdOYW1lfWApO1xuICAgICAgICByZXMgPSB7XG4gICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgIGNvZGU6IENvZGVzLlBBUkFNRVRFUl9FUlJPUixcbiAgICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBhd2FpdCBkZWxldGVNZWV0aW5nKG1lZXRpbmdOYW1lKTtcbiAgICAgICAgcmVzID0ge1xuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgIGNvZGU6IENvZGVzLlNVQ0NFU1MsXG4gICAgICAgIH07XG4gICAgfVxuICAgIGNvbnN0IHJlc3BvbnNlID0gZ2VuZXJhdGVSZXNwb25zZShyZXMpO1xuICAgIGNhbGxiYWNrKG51bGwsIHJlc3BvbnNlKTtcbn07XG5cbi8vICgzKSBhdHRlbmRlZXNcbmNvbnN0IGhhbmRsZUF0dGVuZGVlcyA9IChhY2Nlc3NUb2tlbjogc3RyaW5nLCBtZXRob2Q6IHN0cmluZywgcGF0aFBhcmFtczogeyBba2V5OiBzdHJpbmddOiBzdHJpbmcgfSwgYm9keTogYW55LCBjYWxsYmFjazogYW55KSA9PiB7XG4gICAgY29uc29sZS5sb2coYEhBTkRMRSBhdHRlbmRlZXM6ICR7bWV0aG9kfSAke2JvZHl9YCk7XG4gICAgc3dpdGNoIChtZXRob2QpIHtcbiAgICAgICAgY2FzZSBNZXRob2RzLkdFVDpcbiAgICAgICAgICAgIGhhbmRsZUdldEF0dGVuZGVlcyhhY2Nlc3NUb2tlbiwgcGF0aFBhcmFtcywgYm9keSwgY2FsbGJhY2spO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgTWV0aG9kcy5QT1NUOlxuICAgICAgICAgICAgaGFuZGxlUG9zdEF0dGVuZGVlcyhhY2Nlc3NUb2tlbiwgcGF0aFBhcmFtcywgYm9keSwgY2FsbGJhY2spO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgVW5rbndvbiBtZXRob2Q6ICR7bWV0aG9kfWApO1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBnZW5lcmF0ZVJlc3BvbnNlKHsgc3VjY2VzczogZmFsc2UsIGNvZGU6IENvZGVzLlVOS05PV05fTUVUSE9EIH0pO1xuICAgICAgICAgICAgY2FsbGJhY2sobnVsbCwgcmVzcG9uc2UpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgfVxufTtcblxuLy8vLyAoMy0xKSBHZXQgQXR0ZW5kZWVzXG5jb25zdCBoYW5kbGVHZXRBdHRlbmRlZXMgPSBhc3luYyAoYWNjZXNzVG9rZW46IHN0cmluZywgcGF0aFBhcmFtczogeyBba2V5OiBzdHJpbmddOiBzdHJpbmcgfSwgYm9keTogYW55LCBjYWxsYmFjazogYW55KSA9PiB7XG4gICAgLy8gbGV0IHJlczogUmVzcG9uc2VCb2R5O1xuICAgIC8vIGNvbnN0IHJlc3BvbnNlID0gZ2VuZXJhdGVSZXNwb25zZShyZXMpO1xuICAgIC8vIGNhbGxiYWNrKG51bGwsIHJlc3BvbnNlKTtcbn07XG4vLy8vICgzLTIpIFBvc3QgQXR0ZW5kZWVzXG5jb25zdCBoYW5kbGVQb3N0QXR0ZW5kZWVzID0gYXN5bmMgKGFjY2Vzc1Rva2VuOiBzdHJpbmcsIHBhdGhQYXJhbXM6IHsgW2tleTogc3RyaW5nXTogc3RyaW5nIH0sIGJvZHk6IGFueSwgY2FsbGJhY2s6IGFueSkgPT4ge1xuICAgIGxldCByZXM6IFJlc3BvbnNlQm9keTtcbiAgICBjb25zdCBwYXJhbXMgPSBKU09OLnBhcnNlKGJvZHkpIGFzIEpvaW5NZWV0aW5nUmVxdWVzdDtcblxuICAgIGNvbnN0IGpvaW5JbmZvID0gYXdhaXQgam9pbk1lZXRpbmcocGFyYW1zLm1lZXRpbmdOYW1lLCBwYXJhbXMuYXR0ZW5kZWVOYW1lKTtcbiAgICBpZiAoXCJleGNlcHRpb25cIiBpbiBqb2luSW5mbykge1xuICAgICAgICBjb25zdCBleGNlcHRpb24gPSBqb2luSW5mbyBhcyBKb2luTWVldGluZ0V4Y2VwdGlvbjtcbiAgICAgICAgaWYgKGV4Y2VwdGlvbi5jb2RlID09PSBKb2luTWVldGluZ0V4Y2VwdGlvblR5cGUuTk9fTUVFVElOR19GT1VORCkge1xuICAgICAgICAgICAgcmVzID0ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGNvZGU6IENvZGVzLk5PX1NVQ0hfQV9NRUVUSU5HX1JPT00sXG4gICAgICAgICAgICB9O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVzID0ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGNvZGU6IENvZGVzLlBBUkFNRVRFUl9FUlJPUixcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICByZXMgPSB7XG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgY29kZTogQ29kZXMuU1VDQ0VTUyxcbiAgICAgICAgICAgIGRhdGE6IGpvaW5JbmZvLFxuICAgICAgICB9O1xuICAgIH1cbiAgICBjb25zdCByZXNwb25zZSA9IGdlbmVyYXRlUmVzcG9uc2UocmVzKTtcbiAgICBjYWxsYmFjayhudWxsLCByZXNwb25zZSk7XG59O1xuXG4vLyAoNCkgYXR0ZW5kZWVzXG5jb25zdCBoYW5kbGVBdHRlbmRlZSA9IChhY2Nlc3NUb2tlbjogc3RyaW5nLCBtZXRob2Q6IHN0cmluZywgcGF0aFBhcmFtczogeyBba2V5OiBzdHJpbmddOiBzdHJpbmcgfSwgYm9keTogYW55LCBjYWxsYmFjazogYW55KSA9PiB7XG4gICAgY29uc29sZS5sb2coYEhBTkRMRSBhdHRlbmRlZTogJHttZXRob2R9ICR7Ym9keX1gKTtcbiAgICBzd2l0Y2ggKG1ldGhvZCkge1xuICAgICAgICBjYXNlIE1ldGhvZHMuR0VUOlxuICAgICAgICAgICAgaGFuZGxlR2V0QXR0ZW5kZWUoYWNjZXNzVG9rZW4sIHBhdGhQYXJhbXMsIGJvZHksIGNhbGxiYWNrKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgY29uc29sZS5sb2coYFVua253b24gbWV0aG9kOiAke21ldGhvZH1gKTtcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gZ2VuZXJhdGVSZXNwb25zZSh7IHN1Y2Nlc3M6IGZhbHNlLCBjb2RlOiBDb2Rlcy5VTktOT1dOX01FVEhPRCB9KTtcbiAgICAgICAgICAgIGNhbGxiYWNrKG51bGwsIHJlc3BvbnNlKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgIH1cbn07XG5cbi8vLy8gKDQtMSkgR2V0IEF0dGVuZGVlXG5jb25zdCBoYW5kbGVHZXRBdHRlbmRlZSA9IGFzeW5jIChhY2Nlc3NUb2tlbjogc3RyaW5nLCBwYXRoUGFyYW1zOiB7IFtrZXk6IHN0cmluZ106IHN0cmluZyB9LCBib2R5OiBhbnksIGNhbGxiYWNrOiBhbnkpID0+IHtcbiAgICBsZXQgcmVzOiBSZXNwb25zZUJvZHk7XG4gICAgY29uc3QgbWVldGluZ05hbWUgPSBwYXRoUGFyYW1zW1wibWVldGluZ05hbWVcIl07XG4gICAgY29uc3QgYXR0ZW5kZWVJZCA9IHBhdGhQYXJhbXNbXCJhdHRlbmRlZUlkXCJdO1xuICAgIGlmICghbWVldGluZ05hbWUgfHwgIWF0dGVuZGVlSWQpIHtcbiAgICAgICAgY29uc29sZS5sb2coYHBhcmFtZXRlciBlcnJvcjogJHttZWV0aW5nTmFtZX0sICR7YXR0ZW5kZWVJZH1gKTtcbiAgICAgICAgcmVzID0ge1xuICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICBjb2RlOiBDb2Rlcy5QQVJBTUVURVJfRVJST1IsXG4gICAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgYXR0ZW5kZWVJbmZvID0gYXdhaXQgZ2V0QXR0ZW5kZWVJbmZvKG1lZXRpbmdOYW1lLCBhdHRlbmRlZUlkKTtcblxuICAgICAgICBpZiAoXCJleGNlcHRpb25cIiBpbiBhdHRlbmRlZUluZm8pIHtcbiAgICAgICAgICAgIGNvbnN0IGV4Y2VwdGlvbiA9IGF0dGVuZGVlSW5mbyBhcyBHZXRBdHRlbmRlZUluZm9FeGNlcHRpb247XG4gICAgICAgICAgICBpZiAoZXhjZXB0aW9uLmNvZGUgPT09IEdldEF0dGVuZGVlSW5mb0V4Y2VwdGlvblR5cGUuTk9fQVRURU5ERUVfRk9VTkQpIHtcbiAgICAgICAgICAgICAgICByZXMgPSB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBjb2RlOiBDb2Rlcy5OT19TVUNIX0FOX0FUVEVOREVFLFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlcyA9IHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGNvZGU6IENvZGVzLlBBUkFNRVRFUl9FUlJPUixcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVzID0ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgY29kZTogQ29kZXMuU1VDQ0VTUyxcbiAgICAgICAgICAgICAgICBkYXRhOiBhdHRlbmRlZUluZm8sXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuICAgIGNvbnN0IHJlc3BvbnNlID0gZ2VuZXJhdGVSZXNwb25zZShyZXMpO1xuICAgIGNhbGxiYWNrKG51bGwsIHJlc3BvbnNlKTtcbn07XG4iXX0=